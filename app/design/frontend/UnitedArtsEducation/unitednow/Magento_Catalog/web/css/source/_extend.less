/**
 * @category    ClassyLlama
 * @copyright   Copyright (c) 2017 Classy Llama
 */

& when (@media-common = true) {
    // Use flex-direction:row in IE 11, to prevent height from being inflated by original image height
    .ie11 {
        .column.main .products-grid .product-item-info {
            flex-direction: row;
            flex-wrap: wrap;
        }
        .product-item-photo {
            flex-basis: 100%;
        }
    }

    .fotorama {
        .fotorama__nav--dots {
            .fotorama__nav__frame {
                width: 20px;
                cursor: pointer;
            }
        }
        .fotorama__dot {
            width: 8px;
            height: 8px;
            left: 5px;
            top: 10px;
        }

        .fotorama__active {
            .fotorama__dot {
                border-color: @active__color;
                background-color: @active__color;
            }
        }
    }

    .products-grid {
        .product-item-name {
            flex-grow: 1;
        }

        .product-item-inner {
            .column.main & {
                flex-grow: 0;
            }
        }
    }

    .block-viewed-products-grid {
        .products-grid {
            .product-item {
                flex-basis: 25%;
                max-width: 25%;
                flex-grow: 1;
                margin: 0;
                padding: 1%;
            }
            .product-item-info {
                &:hover,
                &.active {
                    box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.3);
                    border: none;
                    margin: 0;
                    padding: 0;
                }

                .product-item-photo {
                    position: static;
                    display: block;
                    border: 1px solid @border-color__base;
                }
            }
            .product-image-container {
                display: block;
                width: auto !important; // Overrides inline style
            }

            .product-item-details {
                display: none;
            }
        }
        .product-items {
            display: flex;
            flex-wrap: wrap;
        }
    }

    // Compare-products page
    .table-comparison {
        thead {
            th,
            td {
                .lib-css(border-bottom, @table__border-width @table__border-style @table__border-color);
            }
        }

        tr {
            &:not(:first-child) {
                border-top: @table__border-width @table__border-style @table__border-color;
            }
        }

        td {
            &:last-child {
                border-right: none;
            }
        }

        .cell {
            &.remove {
                border-left: none !important; // Overrides other important flag
                padding-top: 8px;
                padding-bottom: 8px;
                text-align: center;

                .action.delete {
                    width: 29px;
                    border-radius: 50%;
                    background: @button__background;

                    &:hover {
                        background: @button__hover__background;
                    }

                    &:active {
                        background: @button__active__background;
                    }

                    &:before {
                        margin-left: 0.5px;
                        color: @button__color;
                        font-size: 15px;
                        line-height: 29px;
                    }
                }
            }

            &.label {
                width: 85px;
                border-right: none;
            }

            &.product.info,
            &.product.attribute {
                border-left: @table__border-width @table__border-style @table__border-color;
            }
        }

        .product-item-photo {
            margin-bottom: 0;
        }

        .product-item-name {
            margin: 10px 0 7px;
        }

        .price-box {
            margin: 0;
        }

        .product-item-actions {
            margin: 10px 0 2px;
        }
    }
}

.media-width(@extremum, @break) when (@extremum = 'max') and (@break = @screen__xs) {
    .block-viewed-products-grid {
        .products-grid {
            li.product-item {
                flex-basis: 33.33%;
                max-width: 33.33%;
            }
        }
    }
}

.media-width(@extremum, @break) when (@extremum = 'min') and (@break = @screen__s) {
    .product-item-actions {
        // Set display:block for primary & secondary actions (instead of table-cell) to prevent horizontal overflow
        .actions-primary {
            display: block;
            flex-basis: 100%;

            + .actions-secondary {
                display: block;
                width: auto;
                padding: 0 2% 0 4%;
                line-height: 33px;
                min-width: 18px;
            }
        }

        .page-products & {
            display: flex;
            justify-content: space-between;

            .actions-primary {
                form {
                    display: flex;
                }

                .label.qty {
                    .lib-visually-hidden();
                }

                input[name="qty"] {
                    width: 26%;
                    height: 35px;
                    text-align: center;
                    margin-right: 5%;
                }
            }
            a.action.primary {
                border-radius: 0;
            }
        }
    }

    .block-viewed-products-grid {
        .products-grid {
            li.product-item {
                flex-basis: 16.66%;
                max-width: 16.66%;
                padding: 0.75%;
            }
        }
    }
}
.media-width(@extremum, @break) when (@extremum = 'min') and (@break = @screen__m) {
    @media (max-width: 960px) {
        .compare.wrapper {
            display: none;
        }
    }

    .block-viewed-products-grid {
        .products-grid {
            li.product-item {
                flex-basis: 100%;
                max-width: 147px;
                padding: 2%;
            }
            .product-item-info {
                .product-item-photo {
                    .sidebar & {
                        position: static;
                        float: none;
                        margin: 0;
                    }
                }
            }
        }
    }

    .sidebar{
        .block-wishlist{
            .product-items{
                .product-item-info{
                    .product-item-photo{
                        float:none;
                    }
                }
            }
        }
    }
}
.media-width(@extremum, @break) when (@extremum = 'min') and (@break = @screen__l) {
    .page-products {
        .products-grid {
            .product-item {
                width: 24.42%;
            }
        }
    }

    .sidebar{
        .block-wishlist{
            .product-items{
                .product-item-info{
                    .product-item-photo{
                        float:left;
                    }
                }
            }
        }
    }

    .block-viewed-products-grid {
        .products-grid {
            li.product-item {
                flex-basis: 50%;
                max-width: 50%;

                .sidebar .block& {
                    padding: 2%;
                }
            }
        }
    }
}
